import numpy as np
last_residuals = [0.019230094285234423, 0.042892854712532624, 0.03755736813157787, 0.042892854712532624, 0.048228213751364685, 
                  0.1197871633376868, 0.09519582164965734, 0.1197871633376868, 0.14437905610621, 0.057006493430759864, 0.03802558817386087, 
                  0.057006493430759864, 0.07598757516496732, 0.3344923009947244, 0.23229500830865973, 0.3344923009947244, 0.43669003381501675, 
                  0.182317100227581, 0.3299401648015135, 0.182317100227581, 0.0346930778844165, 0.05868049879960077, 0.5090075234677818, 
                  0.05868049879960077, 0.3916472431732855, 0.23883058268266838, 0.2598838508335796, 0.23883058268266838, 0.2177786553104119, 
                  0.11280635169205397, 0.16667392045927737, 0.11280635169205397, 0.058938513987027985, 0.008590025995239975, 0.3281879315303604, 
                  0.008590025995239975, 0.34536598529308005, 0.11274423197637704, 0.037666964126388536, 0.11274423197637704, 0.1878190648553213, 
                  0.22089842091753756, 0.4400211205537602, 0.22089842091753756, 0.0017779107725941767, 0.011706269975129274, 0.06733671417191028, 
                  0.011706269975129274, 0.09075151600704268, 0.22044433211392683, 0.25998636955757926, 0.22044433211392683, 0.18090488266058954, 
                  0.16544291370028386, 0.1894070930300376, 0.16544291370028386, 0.14147966546430857, 0.10024767441118437, 0.11830478577396289, 
                  0.10024767441118437, 0.08218898677775019, 0.17147366431970526, 0.21932913693107833, 0.17147366431970526, 0.12361876826596369, 
                  0.2693610420277277, 0.059937491124335135, 0.2693610420277277, 0.5986602792795864, 0.16457301052437423, 0.005908875853742612, 
                  0.16457301052437423, 0.3350546147598311, 0.10261887996026314, 0.31662372567061586, 0.10261887996026314, 0.11138532907132778, 
                  0.22948347120791204, 0.2381222536085685, 0.22948347120791204, 0.22084511076435678, 0.12502901701789623, 0.017593845229899735, 
                  0.12502901701789623, 0.2324622579990207, 0.003931646569633324, 0.17605647295318091, 0.003931646569633324, 0.16819224550290723, 
                  0.13479600819019458, 0.08417719674878865, 0.13479600819019458, 0.22028569398413467, 0.2787102542080554, 0.10160164630530766, 
                  0.18901273229215282, 0.2988466275475818, 0.15262761700125457, 0.17593968883845845, 0.17505183708878963, 0.11810111238220664, 
                  0.12437983813885431, 0.2640401797939056, 0.1916527122567055, 0.1641155485267408, 0.10959738648270642, 0.17479859267554437, 
                  0.07596094942378256, 0.033183913479496036, 0.12287225263034676, 0.18947540087809606, 0.0892358155714229, 0.37915910395640295, 
                  0.2681992165566166, 0.3533094979359108, 0.23456277949767887, 0.0709655684997916, 0.22340643381449365, 0.12255283539204173, 
                  0.257042870873421, 0.3354729324643001, 0.2940224895203389, 0.1749811788047187, 0.2267494015472278, 0.2897320811232791, 
                  0.2650198648001568, 0.21982437388494425, 0.3210807358018722, 0.3999128776313171, 0.2350404000528994, 0.25828961096894043, 
                  0.20140396299397553, 0.13330621670607293, 0.07872082193952079, 0.039279030217442834, 0.10114525588231574, 0.1293748678422718, 
                  0.08806836202904234, 0.09332533466792706, 0.06564414194150728, 0.026750518388452688, 0.14254313729358467, 0.015922309732782636,
                  0.12011891720604961, 0.24494744962405904, 0.06346138645748484, 0.06295702628613883, 0.07467338957361722, 0.06396473026882427, 
                  0.02557901004732882, 0.21089035909561613, 0.02557901004732882, 0.20598673729399844, 0.09144498505591833, 0.23846526145867783, 
                  0.057808334141731116, 0.3092353969157899, 0.05128830989171301, 0.25740330619136376, 0.15219804877901477, 0.02456804330024792, 
                  0.0028681875021176195, 0.15927365848910843, 0.025292407589652677, 0.20985906987616362, 0.09453967024511747, 0.09539354288453511, 
                  0.04969101621480135, 0.2844742006381622, 0.011342288591859734, 0.09822304810802249, 0.00013007162045705623, 0.00826645058616543, 
                  0.21583390393577206, 0.46634187052077214, 0.21583390393577206, 0.03260130239542136, 0.49782053064718196, 0.517378172385903,
                  0.44175965964546315, 0.4558379351355321, 0.2541195612728274, 0.10198504822182472, 0.23169534118529234, 0.3614071901645588, 
                  0.21154820462078103, 0.32248182812348936, 0.17791155370659728
]

new_residuals = [0.22028569398413467, 0.2787102542080554, 0.10160164630530766, 0.18901273229215282, 0.2988466275475818, 
                 0.15262761700125457, 0.17593968883845845, 0.17505183708878963, 0.11810111238220664, 0.12437983813885431, 
                 0.2640401797939056, 0.1916527122567055, 0.1641155485267408, 0.10959738648270642, 0.17479859267554437, 
                 0.07596094942378256, 0.033183913479496036, 0.12287225263034676, 0.18947540087809606, 0.0892358155714229, 
                 0.37915910395640295, 0.2681992165566166, 0.3533094979359108, 0.23456277949767887, 0.0709655684997916, 
                 0.22340643381449365, 0.12255283539204173, 0.257042870873421, 0.3354729324643001, 0.2940224895203389, 
                 0.1749811788047187, 0.2267494015472278, 0.2897320811232791, 0.2650198648001568, 0.21982437388494425, 
                 0.3210807358018722, 0.3999128776313171, 0.2350404000528994, 0.25828961096894043, 0.20140396299397553, 
                 0.13330621670607293, 0.07872082193952079, 0.039279030217442834, 0.10114525588231574, 0.1293748678422718, 
                 0.08806836202904234, 0.09332533466792706, 0.06564414194150728, 0.026750518388452688, 0.14254313729358467,
                 0.015922309732782636, 0.12011891720604961, 0.24494744962405904, 0.06346138645748484, 0.06295702628613883, 
                 0.07467338957361722, 0.06396473026882427, 0.02557901004732882, 0.21089035909561613, 0.02557901004732882, 
                 0.20598673729399844, 0.09144498505591833, 0.23846526145867783, 0.057808334141731116, 0.3092353969157899, 
                 0.05128830989171301, 0.25740330619136376, 0.15219804877901477, 0.02456804330024792, 0.0028681875021176195, 
                 0.15927365848910843, 0.025292407589652677, 0.20985906987616362, 0.09453967024511747, 0.09539354288453511, 
                 0.04969101621480135, 0.2844742006381622, 0.011342288591859734, 0.09822304810802249, 0.00013007162045705623, 
                 0.00826645058616543, 0.21583390393577206, 0.46634187052077214, 0.21583390393577206, 0.03260130239542136, 
                 0.49782053064718196, 0.517378172385903, 0.44175965964546315, 0.4558379351355321, 0.2541195612728274, 
                 0.10198504822182472, 0.23169534118529234, 0.3614071901645588, 0.21154820462078103, 0.32248182812348936, 
                 0.17791155370659728
]

expected = [88, 89, 90, 91, 92, 93, 94, 95]

from new_formula import FormulaFactory
residuals = np.array([last_residuals + new_residuals])
formula = FormulaFactory.build_formula("F", 50, 0.009397522374664624)
evaluation = formula.evaluate(residuals.reshape(-1, 1), labels=False)
print(evaluation)
evaluation = np.array(evaluation)
print(np.where(evaluation < 0)[0])